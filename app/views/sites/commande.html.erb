<!-- multistep form -->

<div id="all_form">
<div class="formulaire" id="form_input">
  <center><h1 id="title_prod"><%=@page.title %></h1><center>
<form id="msform">
 <!-- progressbar -->
 <ul id="progressbar">
   <li class="active">Vos Informations</li>
   <li>Lieu de l'intervention</li>
   <li>Vide</li>
 </ul>
 <!-- fieldsets -->
 <fieldset>
   <h2 class="fs-title">Vos Informations</h2><br/>
   <input type="text" name="nom" placeholder="Nom" required/>
   <input type="text" name="prenom" placeholder="Prénom" required/>
   <input type="email" name="mail" placeholder="Email" required/>
   <input type="text" name="tel" placeholder="Télépone" required/>
   <input type="button" name="next" class="next action-button" value="Next" />
 </fieldset>
 <fieldset>
   <h2 class="fs-title">Lieu de l'intervention</h2><br/>
   <input type="text" name="adresse" placeholder="Adresse" required/>
   <input type="text" name="postal" placeholder="Code Postal" required/>
   <input type="text" name="etage" placeholder="Interphone/Digicode/Etage" required/>
   <input type="button" name="previous" class="previous action-button" value="Previous" />
   <input type="button" name="next" class="next action-button" value="Next" />
 </fieldset>
 <fieldset>
   <h2 class="fs-title">Vide</h2><br/>
   <!---select quand----->
   <input type="text" name="promo" placeholder="Code Promo" />
   <!---checkbox--->
   <input type="button" name="previous" class="previous action-button" value="Previous" />
   <input type="submit" name="submit" class="submit action-button" value="Submit" />
 </fieldset>
</form>
</div>

<div class="formulaire" id="preview_prod">
  <%= image_tag @page.image, :id => "img_prod" %>
  <div class="prix">
    <h3 class="left"> PRIX DE L'INTERVENTION</h3>
    <h3 class="right"> ENTRE <%= @page.min_price %> et <%= @page.max_price %> € </h3>
  </div>

  <div class="prix">
    <h3 class="left" > TEMPS DE L'INTERVENTION <span>__--__</span> </h3>
    <h3 class="right"> <%= @page.time %> </h3>
  </div>
  <p>
    Un de nos artisans te rappellera dans les 20 minutes pour fixer un rdv avec toi. Une fois sur place, il te fera un devis définitif que tu seras libre d'accepter ou non. Si tu n'acceptes pas le devis, aucun frais bancaire ne te sera prélevé.
  </p>
</div>
</div>
<script>
  //jQuery time
  var current_fs, next_fs, previous_fs; //fieldsets
  var left, opacity, scale; //fieldset properties which we will animate
  var animating; //flag to prevent quick multi-click glitches

  $(".next").click(function(){
	   if(animating) return false;
	    animating = true;

	     current_fs = $(this).parent();
	      next_fs = $(this).parent().next();

	//activate next step on progressbar using the index of next_fs
	$("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

	//show the next fieldset
	next_fs.show();
	//hide the current fieldset with style
	current_fs.animate({opacity: 0}, {
		step: function(now, mx) {
			//as the opacity of current_fs reduces to 0 - stored in "now"
			//1. scale current_fs down to 80%
			scale = 1 - (1 - now) * 0.2;
			//2. bring next_fs from the right(50%)
			left = (now * 50)+"%";
			//3. increase opacity of next_fs to 1 as it moves in
			opacity = 1 - now;
			current_fs.css({
        'transform': 'scale('+scale+')',
        'position': 'absolute'
      });
			next_fs.css({'left': left, 'opacity': opacity});
		},
		duration: 800,
		complete: function(){
			current_fs.hide();
			animating = false;
		},
		//this comes from the custom easing plugin
		easing: 'easeInOutBack'
	 });
  });

  $(".previous").click(function(){
	   if(animating) return false;
	    animating = true;

	current_fs = $(this).parent();
	previous_fs = $(this).parent().prev();

	//de-activate current step on progressbar
	$("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

	//show the previous fieldset
	previous_fs.show();
	//hide the current fieldset with style
	current_fs.animate({opacity: 0}, {
		step: function(now, mx) {
			//as the opacity of current_fs reduces to 0 - stored in "now"
			//1. scale previous_fs from 80% to 100%
			scale = 0.8 + (1 - now) * 0.2;
			//2. take current_fs to the right(50%) - from 0%
			left = ((1-now) * 50)+"%";
			//3. increase opacity of previous_fs to 1 as it moves in
			opacity = 1 - now;
			current_fs.css({'left': left});
			previous_fs.css({'transform': 'scale('+scale+')', 'opacity': opacity});
		},
		duration: 800,
		complete: function(){
			current_fs.hide();
			animating = false;
		},
		//this comes from the custom easing plugin
		easing: 'easeInOutBack'
	 });
  });

  $(".submit").click(function(){
	   return false;
   })
</script>
